---
interface Props {
  title: string
  link?: string
  date: Date
  updated?: Date
  wordCount?: number
  readingTime?: number
}

const { title, link, date, wordCount, readingTime } = Astro.props

// Format date helper
function formatDate(d: Date): string {
  return d.toLocaleDateString('zh-CN', {
    year: 'numeric',
    month: '2-digit',
    day: '2-digit',
  })
}

// Format full date helper
function formatFullDate(d: Date): string {
  return d.toLocaleString('zh-CN', {
    year: 'numeric',
    month: '2-digit',
    day: '2-digit',
    hour: '2-digit',
    minute: '2-digit',
    second: '2-digit',
  })
}

// Calculate reading time (assuming 200 words per minute)
const estimatedReadingTime = wordCount ? Math.ceil(wordCount / 200) : readingTime || 1
---

<header>
  <h1 class="title" itemprop="name headline">
    {
      link ? (
        <a href={link} class="link external" itemprop="url">
          {title}
          <i class="ic i-ri-link" />
        </a>
      ) : (
        title
      )
    }
  </h1>

  <div class="meta">
    <span class="item" title={`创建于: ${formatFullDate(date)}`}>
      <span class="icon">
        <i class="ic i-ri-calendar-line"></i>
      </span>
      <span class="text">发表于 </span>
      <time itemprop="dateCreated datePublished" datetime={date.toISOString()}>
        {formatDate(date)}
      </time>
    </span>

    {
      wordCount && (
        <span class="item" title="字数统计">
          <span class="icon">
            <i class="ic i-ri-edit-2-line" />
          </span>
          <span class="text">字数统计 </span>
          <span>{wordCount.toLocaleString()}</span>
          <span class="text"> 字</span>
        </span>
      )
    }

    <span class="item" title="阅读时长">
      <span class="icon">
        <i class="ic i-ri-time-line"></i>
      </span>
      <span class="text">阅读时长 </span>
      <span>{estimatedReadingTime} 分钟</span>
    </span>
  </div>
</header>
